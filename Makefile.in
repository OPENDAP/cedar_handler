@SET_MAKE@

something=
prefix = @prefix@
exec_prefix = $(prefix)
bindir = $(exec_prefix)/cgi-bin
libdir = $(exec_prefix)/lib
includedir = $(prefix)/include
AR = ar
RANLIB = @RANLIB@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@

SRCS:=cedar_read_attributes.cc cedar_read_descriptors.cc cedar_read_tab.cc \
	cedar_read_tab_support.cc cedar_read_info.cc CedarFilter.cc \
	CedarTab.cc CedarFlat.cc cedar_read_flat.cc cedar_read_stream.cc \
	CedarRequestHandler.cc cedar_module.cc \
	FlatResponseHandler.cc TabResponseHandler.cc \
	StreamResponseHandler.cc DODSContainerPersistenceCedar.cc \
	CedarReporter.cc InfoResponseHandler.cc
HDRS:=CedarFilter.h CedarFlat.h CedarRequestHandler.h CedarResponseNames.h \
	CedarTab.h FlatResponseHandler.h StreamResponseHandler.h \
	TabResponseHandler.h cedar_read_attributes.h \
	cedar_read_descriptors.h cedar_read_flat.h cedar_read_info.h \
	cedar_read_stream.h cedar_read_tab.h cedar_read_tab_support.h \
	cedar_version.h config_cedar.h DODSContainerPersistenceCedar.h \
	CedarReporter.h InfoResponseHandler.h
OBJS:=cedar_read_attributes.o cedar_read_descriptors.o cedar_read_tab.o \
	cedar_read_tab_support.o cedar_read_info.o CedarFilter.o \
	CedarTab.o CedarFlat.o cedar_read_flat.o cedar_read_stream.o \
	CedarRequestHandler.o FlatResponseHandler.o TabResponseHandler.o \
	StreamResponseHandler.o DODSContainerPersistenceCedar.o \
	CedarReporter.o InfoResponseHandler.o
MODOBJS:=cedar_module.o cedar_persistence.o
INCS:=-I. -I../dispatch @INCS@
LIB:=libcedar-handler.a
LIBS = @LIBS@
MODS = @MODS@
DEFS:=@DEFS@
#CXXFLAGS_DEBUG:=-g3 -O0 -Wall -fno-default-inline -fno-defer-pop
#CXXFLAGS:=$(CXXFLAGS_DEBUG) 
CXXFLAGS:=@CXXFLAGS@ -Wall -Wno-deprecated
CPPFLAGS:=$(CXXFLAGS) $(DEFS) $(INCS)

HANDLER:=cedar_handler

all : $(HANDLER)

lib : $(LIB) $(MODOBJS)

%.o : %.cc
	g++ -c -gstabs -O2 $(CPPFLAGS) $<

$(LIB) : $(OBJS)
	$(AR) cru $@ $?
	$(RANLIB) $@

$(HANDLER) : $(LIB) $(MODOBJS) $(HANDLER).o $(MODS)
	g++ -o $(HANDLER) $(HANDLER).o $(MODS) $(MODOBJS) $(LIB) $(LIBS)

clean :
	/bin/rm -rf $(OBJS) $(LIB) $(MODOBJS) $(HANDLER).o $(HANDLER)

install: $(HANDLER) install-mods install-progs
	-mkdir -p $(libdir)
	$(INSTALL_DATA) $(LIB) $(libdir)
	$(RANLIB) $(libdir)/$(LIB)

install-mods:
	-mkdir -p $(libdir)
	for h in $(MODOBJS); \
	    do $(INSTALL_DATA) $$h $(libdir); done

install-progs: $(HANDLER)
	-mkdir -p $(bindir)
	$(INSTALL_PROGRAM) -s $(HANDLER) $(bindir)

Makefile: Makefile.in
	if [ -x ./config.status ]; \
	then \
	    ${SHELL} ./config.status; \
	else \
	    ./configure; \
	fi

.PHONY: depend

depend: 
	@depend@ -m Makefile.in -- $(CPPFLAGS) -- $(SRCS) $(TESTSRCS)
	$(MAKE) $(MFLAGS) Makefile

# DO NOT DELETE; depend requires this line
